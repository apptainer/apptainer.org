

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Remote Endpoints &mdash; Singularity User Guide 3.8 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/favicon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/js/ga.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Cloud Library" href="cloud_library.html" />
    <link rel="prev" title="Encrypted Containers" href="encryption.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Singularity User Guide
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.8
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to Singularity</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security in Singularity</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build_a_container.html">Build a container</a></li>
<li class="toctree-l1"><a class="reference internal" href="definition_files.html">The Definition File</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_env.html">Build Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="singularity_and_docker.html">Singularity and Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="fakeroot.html">Fakeroot feature</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="signNverify.html">Sign and Verify</a></li>
<li class="toctree-l1"><a class="reference internal" href="key_commands.html">Key management commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="encryption.html">Encrypted Containers</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Remote Endpoints</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#public-sylabs-cloud">Public Sylabs Cloud</a></li>
<li class="toctree-l2"><a class="reference internal" href="#managing-remote-endpoints">Managing Remote Endpoints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#list-and-login-to-remotes">List and Login to Remotes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-remove-remotes">Add &amp; Remove Remotes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#set-the-default-remote">Set the Default Remote</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#keyserver-configurations">Keyserver Configurations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#managing-oci-registries">Managing OCI Registries</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cloud_library.html">Cloud Library</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="bind_paths_and_mounts.html">Bind Paths and Mounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="persistent_overlays.html">Persistent Overlays</a></li>
<li class="toctree-l1"><a class="reference internal" href="running_services.html">Running Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_and_metadata.html">Environment and Metadata</a></li>
<li class="toctree-l1"><a class="reference internal" href="oci_runtime.html">OCI Runtime Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="security_options.html">Security Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="networking.html">Network Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="cgroups.html">Cgroups Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpi.html">Singularity and MPI applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu.html">GPU Support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Singularity User Guide</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Remote Endpoints</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/hpcng/singularity-userdocs/blob/master/endpoint.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="remote-endpoints">
<h1>Remote Endpoints<a class="headerlink" href="#remote-endpoints" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">remote</span></code> command group allows users to manage the service endpoints
Singularity will interact with for many common command flows. This includes
managing credentials for image storage services, remote builders, and key
servers used to locate public keys for SIF image verification. Currently,
there are three main types of remote endpoints managed by this command group:
the public Sylabs Cloud (or local Singularity Enterprise installation), OCI
registries and keyservers.</p>
</div>
<div class="section" id="public-sylabs-cloud">
<h2>Public Sylabs Cloud<a class="headerlink" href="#public-sylabs-cloud" title="Permalink to this headline">¶</a></h2>
<p>Sylabs introduced the online <a class="reference external" href="https://cloud.sylabs.io/home">Sylabs Cloud</a> to enable users to <a class="reference external" href="https://cloud.sylabs.io/builder">Create</a>, <a class="reference external" href="https://cloud.sylabs.io/keystore?sign=true">Secure</a>, and <a class="reference external" href="https://cloud.sylabs.io/library">Share</a> their container
images with others.</p>
<p>A fresh, default installation of Singularity is configured to connect
to the public <a class="reference external" href="https://cloud.sylabs.io">cloud.sylabs.io</a>
services. If you only want to use the public services you just need to
obtain an authentication token, and then <code class="docutils literal notranslate"><span class="pre">singularity</span> <span class="pre">remote</span> <span class="pre">login</span></code>:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Go to: <a class="reference external" href="https://cloud.sylabs.io/">https://cloud.sylabs.io/</a></p></li>
<li><p>Click “Sign In” and follow the sign in steps.</p></li>
<li><p>Click on your login id (same and updated button as the Sign in one).</p></li>
<li><p>Select “Access Tokens” from the drop down menu.</p></li>
<li><p>Enter a name for your new access token, such as “test token”</p></li>
<li><p>Click the “Create a New Access Token” button.</p></li>
<li><p>Click “Copy token to Clipboard” from the “New API Token” page.</p></li>
<li><p>Run <code class="docutils literal notranslate"><span class="pre">singularity</span> <span class="pre">remote</span> <span class="pre">login</span></code> and paste the access token at the prompt.</p></li>
</ol>
</div></blockquote>
<p>Once your token is stored, you can check that you are able to connect
to the services with the <code class="docutils literal notranslate"><span class="pre">status</span></code> subcommand:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>singularity remote status
<span class="go">INFO:    Checking status of default remote.</span>
<span class="go">SERVICE    STATUS  VERSION             URI</span>
<span class="go">Builder    OK      v1.1.14-0-gc7a68c1  https://build.sylabs.io</span>
<span class="go">Consent    OK      v1.0.2-0-g2a24b4a   https://auth.sylabs.io/consent</span>
<span class="go">Keyserver  OK      v1.13.0-0-g13c778b  https://keys.sylabs.io</span>
<span class="go">Library    OK      v1.0.16-0-gb7eeae4  https://library.sylabs.io</span>
<span class="go">Token      OK      v1.0.2-0-g2a24b4a   https://auth.sylabs.io/token</span>
<span class="go">INFO:    Access Token Verified!</span>

<span class="go">Valid authentication token set (logged in).</span>
</pre></div>
</div>
<p>If you see any errors you may need to check if your system requires
proxy environment variables to be set, or if a firewall is blocking
access to <code class="docutils literal notranslate"><span class="pre">*.sylabs.io</span></code>. Talk to your system administrator.</p>
<p>You can interact with the public Sylabs Cloud using various Singularity commands:</p>
<p><a class="reference external" href="cli/singularity_pull.html">pull</a>,
<a class="reference external" href="cli/singularity_push.html">push</a>,
<a class="reference external" href="cli/singularity_build.html#options">build –remote</a>,
<a class="reference external" href="cli/singularity_key.html">key</a>,
<a class="reference external" href="cli/singularity_search.html">search</a>,
<a class="reference external" href="cli/singularity_verify.html">verify</a>,
<a class="reference external" href="cli/singularity_exec.html">exec</a>,
<a class="reference external" href="cli/singularity_shell.html">shell</a>,
<a class="reference external" href="cli/singularity_run.html">run</a>,
<a class="reference external" href="cli/singularity_instance.html">instance</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">docker://</span></code>, <code class="docutils literal notranslate"><span class="pre">oras://</span></code> and <code class="docutils literal notranslate"><span class="pre">shub://</span></code> URIs with these commands
does not interact with the Sylabs Cloud.</p>
</div>
</div>
<div class="section" id="managing-remote-endpoints">
<h2>Managing Remote Endpoints<a class="headerlink" href="#managing-remote-endpoints" title="Permalink to this headline">¶</a></h2>
<p>Users can setup and switch between multiple remote endpoints, which
are stored in their <code class="docutils literal notranslate"><span class="pre">~/.singularity/remote.yaml</span></code>
file. Alternatively, remote endpoints can be set system-wide by an
administrator.</p>
<p>Generally, users and administrators should manage remote endpoints
using the <code class="docutils literal notranslate"><span class="pre">singularity</span> <span class="pre">remote</span></code> command, and avoid editing
<code class="docutils literal notranslate"><span class="pre">remote.yaml</span></code> configuration files directly.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following commands in this section configures Singularity to use
and authenticate to the public Sylabs Cloud, a private installation
of Singularity Enterprise, or community-developed services that are
API compatible.</p>
</div>
<div class="section" id="list-and-login-to-remotes">
<h3>List and Login to Remotes<a class="headerlink" href="#list-and-login-to-remotes" title="Permalink to this headline">¶</a></h3>
<p>To <code class="docutils literal notranslate"><span class="pre">list</span></code> existing remote endpoints, run this:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity remote list

Cloud Services Endpoints
========================

NAME         URI              ACTIVE  GLOBAL  EXCLUSIVE
SylabsCloud  cloud.sylabs.io  YES     YES     NO

Keyservers
==========

URI                     GLOBAL  INSECURE  ORDER
https://keys.sylabs.io  YES     NO        1*
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">YES</span></code> in the <code class="docutils literal notranslate"><span class="pre">ACTIVE</span></code> column for <code class="docutils literal notranslate"><span class="pre">SylabsCloud</span></code> shows that this is the
current default remote endpoint.</p>
<p>To <code class="docutils literal notranslate"><span class="pre">login</span></code> to a remote, for the first time or if your token expires
or was revoked:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp"># </span>Login to the default remote endpoint
<span class="gp">$ </span>singularity remote login

<span class="gp"># </span>Login to another remote endpoint
<span class="gp">$ </span>singularity remote login &lt;remote_name&gt;

<span class="gp"># </span>example...
<span class="gp">$ </span>singularity remote login SylabsCloud
<span class="go">singularity remote login SylabsCloud</span>
<span class="go">INFO:    Authenticating with remote: SylabsCloud</span>
<span class="go">Generate an API Key at https://cloud.sylabs.io/auth/tokens, and paste here:</span>
<span class="go">API Key:</span>
<span class="go">INFO:    API Key Verified!</span>
</pre></div>
</div>
<p>If you <code class="docutils literal notranslate"><span class="pre">login</span></code> to a remote that you already have a valid token for,
you will be prompted, and the new token will be verified, before it
replaces your existing credential. If you enter an incorrect token
your existing token will not be replaced:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$ </span>singularity remote login
<span class="go">An access token is already set for this remote. Replace it? [N/y]y</span>
<span class="go">Generate an access token at https://cloud.sylabs.io/auth/tokens, and paste it here.</span>
<span class="go">Token entered will be hidden for security.</span>
<span class="go">Access Token:</span>
<span class="go">FATAL:   while verifying token: error response from server: Invalid Credentials</span>

<span class="gp"># </span>Previous token is still <span class="k">in</span> place
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is important for users to be aware that the login command will store the
supplied credentials or tokens unencrypted in your home directory.</p>
</div>
</div>
<div class="section" id="add-remove-remotes">
<h3>Add &amp; Remove Remotes<a class="headerlink" href="#add-remove-remotes" title="Permalink to this headline">¶</a></h3>
<p>To <code class="docutils literal notranslate"><span class="pre">add</span></code> a remote endpoint (for the current user only):</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity remote add &lt;remote_name&gt; &lt;remote_uri&gt;
</pre></div>
</div>
<p>For example, if you have an installation of Singularity enterprise
hosted at enterprise.example.com:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity remote add myremote https://enterprise.example.com

INFO:    Remote &quot;myremote&quot; added.
INFO:    Authenticating with remote: myremote
Generate an API Key at https://enterprise.example.com/auth/tokens, and paste here:
API Key:
</pre></div>
</div>
<p>You will be prompted to setup an API key as the remote is added. The
web address needed to do this will always be given.</p>
<p>To <code class="docutils literal notranslate"><span class="pre">add</span></code> a global remote endpoint (available to all users on the
system) an administrative user should run:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo singularity remote add --global &lt;remote_name&gt; &lt;remote_uri&gt;

# example..

$ sudo singularity remote add --global company-remote https://enterprise.example.com
[sudo] password for dave:
INFO:    Remote &quot;company-remote&quot; added.
INFO:    Global option detected. Will not automatically log into remote.
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Global remote configurations can only be modified by the
root user and are stored in the <code class="docutils literal notranslate"><span class="pre">etc/singularity/remote.yaml</span></code>
file, at the Singularity installation location.</p>
</div>
<p>Conversely, to <code class="docutils literal notranslate"><span class="pre">remove</span></code> an endpoint:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity remote remove &lt;remote_name&gt;
</pre></div>
</div>
<p>Use the <code class="docutils literal notranslate"><span class="pre">--global</span></code> option as the root user to remove a global
endpoint:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo singularity remote remove --global &lt;remote_name&gt;
</pre></div>
</div>
</div>
<div class="section" id="set-the-default-remote">
<h3>Set the Default Remote<a class="headerlink" href="#set-the-default-remote" title="Permalink to this headline">¶</a></h3>
<p>A remote endpoint can be set as the default to use with commands such
as <code class="docutils literal notranslate"><span class="pre">push</span></code>, <code class="docutils literal notranslate"><span class="pre">pull</span></code> etc. via <code class="docutils literal notranslate"><span class="pre">remote</span> <span class="pre">use</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity remote use &lt;remote_name&gt;
</pre></div>
</div>
<p>The default remote shows up with a <code class="docutils literal notranslate"><span class="pre">YES</span></code> under the <code class="docutils literal notranslate"><span class="pre">ACTIVE</span></code> column in the output of <code class="docutils literal notranslate"><span class="pre">remote</span> <span class="pre">list</span></code>:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity remote list
Cloud Services Endpoints
========================

NAME            URI                     ACTIVE  GLOBAL  EXCLUSIVE
SylabsCloud     cloud.sylabs.io         YES     YES     NO
company-remote  enterprise.example.com  NO      YES     NO
myremote        enterprise.example.com  NO      NO      NO

Keyservers
==========

URI                     GLOBAL  INSECURE  ORDER
https://keys.sylabs.io  YES     NO        1*

* Active cloud services keyserver

$ singularity remote use myremote
INFO:    Remote &quot;myremote&quot; now in use.

$ singularity remote list
Cloud Services Endpoints
========================

NAME            URI                     ACTIVE  GLOBAL  EXCLUSIVE
SylabsCloud     cloud.sylabs.io         NO      YES     NO
company-remote  enterprise.example.com  NO      YES     NO
myremote        enterprise.example.com  YES     NO      NO

Keyservers
==========

URI                       GLOBAL  INSECURE  ORDER
https://keys.example.com  YES     NO        1*

* Active cloud services keyserver
</pre></div>
</div>
<p>Singularity 3.7 introduces the ability for an administrator to make a remote
the only usable remote for the system by using the <code class="docutils literal notranslate"><span class="pre">--exclusive</span></code> flag:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo singularity remote use --exclusive company-remote
INFO:    Remote &quot;company-remote&quot; now in use.
$ singularity remote list
Cloud Services Endpoints
========================

NAME            URI                     ACTIVE  GLOBAL  EXCLUSIVE
SylabsCloud     cloud.sylabs.io         NO      YES     NO
company-remote  enterprise.example.com  YES     YES     YES
myremote        enterprise.example.com  NO      NO      NO

Keyservers
==========

URI                       GLOBAL  INSECURE  ORDER
https://keys.example.com  YES     NO        1*

* Active cloud services keyserver
</pre></div>
</div>
<p>This, in turn, prevents users from changing the remote they use:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity remote use myremote
FATAL:   could not use myremote: remote company-remote has been set exclusive by the system administrator
</pre></div>
</div>
<p>If you do not want to switch remote with <code class="docutils literal notranslate"><span class="pre">remote</span> <span class="pre">use</span></code> you can:</p>
<ul class="simple">
<li><p>Make <code class="docutils literal notranslate"><span class="pre">push</span></code> and <code class="docutils literal notranslate"><span class="pre">pull</span></code> use an alternative library server with
the <code class="docutils literal notranslate"><span class="pre">--library</span></code> option.</p></li>
<li><p>Make <code class="docutils literal notranslate"><span class="pre">build</span> <span class="pre">--remote</span></code> use an alternative remote builder with the
<code class="docutils literal notranslate"><span class="pre">--builder</span></code> option.</p></li>
<li><p>Make <code class="docutils literal notranslate"><span class="pre">keys</span></code> use an alternative keyserver with the <code class="docutils literal notranslate"><span class="pre">-url</span></code> option.</p></li>
</ul>
</div>
</div>
<div class="section" id="keyserver-configurations">
<h2>Keyserver Configurations<a class="headerlink" href="#keyserver-configurations" title="Permalink to this headline">¶</a></h2>
<p>By default, Singularity will use the keyserver correlated to the active cloud
service endpoint. This behavior can be changed or supplemented via the
<code class="docutils literal notranslate"><span class="pre">add-keyserver</span></code> and <code class="docutils literal notranslate"><span class="pre">remove-keyserver</span></code> commands. These commands allow an
administrator to create a global list of key servers used to verify container
signatures by default, where <code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">1</span></code> is the first in the list. Other
operations performed by Singularity that reach out to a keyserver will only
use the first entry, or <code class="docutils literal notranslate"><span class="pre">order</span> <span class="pre">1</span></code>, keyserver.</p>
<p>When we list our default remotes, we can see that the default keyserver is
<code class="docutils literal notranslate"><span class="pre">https://keys.sylabs.io</span></code> and the asterisk next to its order indicates that
it is the keyserver associated to the current remote endpoint. We can also see
the <code class="docutils literal notranslate"><span class="pre">INSECURE</span></code> column indicating that Singularity will use TLS when
communicating with the keyserver.</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity remote list
Cloud Services Endpoints
========================

NAME         URI              ACTIVE  GLOBAL  EXCLUSIVE
SylabsCloud  cloud.sylabs.io  YES     YES     NO

Keyservers
==========

URI                     GLOBAL  INSECURE  ORDER
https://keys.sylabs.io  YES     NO        1*

* Active cloud services keyserver
</pre></div>
</div>
<p>We can add a key server to list of keyservers with:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo singularity remote add-keyserver https://pgp.example.com
$ singularity remote list
Cloud Services Endpoints
========================

NAME         URI              ACTIVE  GLOBAL  EXCLUSIVE
SylabsCloud  cloud.sylabs.io  YES     YES     NO

Keyservers
==========

URI                      GLOBAL  INSECURE  ORDER
https://keys.sylabs.io   YES     NO        1*
https://pgp.example.com  YES     NO        2

* Active cloud services keyserver
</pre></div>
</div>
<p>Here we can see that the <code class="docutils literal notranslate"><span class="pre">https://pgp.example.com</span></code> keyserver was appended to
our list. If we would like to specify the order in the list that this key is
placed, we can use the <code class="docutils literal notranslate"><span class="pre">--order</span></code> flag:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo singularity remote add-keyserver --order 1 https://pgp.example.com
$ singularity remote list
Cloud Services Endpoints
========================

NAME         URI              ACTIVE  GLOBAL  EXCLUSIVE
SylabsCloud  cloud.sylabs.io  YES     YES     NO

Keyservers
==========

URI                      GLOBAL  INSECURE  ORDER
https://pgp.example.com  YES     NO        1
https://keys.sylabs.io   YES     NO        2*

* Active cloud services keyserver
</pre></div>
</div>
<p>Since we specified <code class="docutils literal notranslate"><span class="pre">--order</span> <span class="pre">1</span></code>, the <code class="docutils literal notranslate"><span class="pre">https://pgp.example.com</span></code> keyserver was
placed as the first entry in the list and the default keyserver was moved to
second in the list. With the keyserver configuration above, all image default
image verification performed by Singularity will first reach out to
<code class="docutils literal notranslate"><span class="pre">https://pgp.example.com</span></code> and then to <code class="docutils literal notranslate"><span class="pre">https://keys.sylabs.io</span></code> when
searching for public keys.</p>
<p>If a keyserver requires authentication before usage, users can login before
using it:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity remote login --username ian https://pgp.example.com
Password (or token when username is empty):
INFO:    Token stored in /home/ian/.singularity/remote.yaml
</pre></div>
</div>
<p>Now we can see that <code class="docutils literal notranslate"><span class="pre">https://pgp.example.com</span></code> is logged in:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity remote list
Cloud Services Endpoints
========================

NAME         URI              ACTIVE  GLOBAL  EXCLUSIVE
SylabsCloud  cloud.sylabs.io  YES     YES     NO

Keyservers
==========

URI                      GLOBAL  INSECURE  ORDER
https://pgp.example.com  YES     NO        1
https://keys.sylabs.io   YES     NO        2*

* Active cloud services keyserver

Authenticated Logins
=================================

URI                     INSECURE
https://pgp.example.com NO
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is important for users to be aware that the login command will store the
supplied credentials or tokens unencrypted in your home directory.</p>
</div>
</div>
<div class="section" id="managing-oci-registries">
<span id="sec-managing-oci-registries"></span><h2>Managing OCI Registries<a class="headerlink" href="#managing-oci-registries" title="Permalink to this headline">¶</a></h2>
<p>It is common for users of Singularity to use OCI registries as sources for
their container images. Some registries require credentials to access certain
images or the registry itself. Previously, the only methods in Singularity to
supply credentials to registries were to supply credentials for each command or
set environment variables for a single registry.
See <a class="reference internal" href="singularity_and_docker.html#sec-authentication-via-docker-login"><span class="std std-ref">Authentication via Interactive Login</span></a>
and <a class="reference internal" href="singularity_and_docker.html#sec-authentication-via-environment-variables"><span class="std std-ref">Authentication via Environment Variables</span></a></p>
<p>Singularity 3.7 introduces the ability for users to supply credentials on a per
registry basis with the <code class="docutils literal notranslate"><span class="pre">remote</span></code> command group.</p>
<p>Users can login to an oci registry with the <code class="docutils literal notranslate"><span class="pre">remote</span> <span class="pre">login</span></code> command by
specifying a <code class="docutils literal notranslate"><span class="pre">docker://</span></code> prefix to the registry hostname:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity remote login --username ian docker://docker.io
Password (or token when username is empty):
INFO:    Token stored in /home/ian/.singularity/remote.yaml

$ singularity remote list
Cloud Services Endpoints
========================

NAME         URI              ACTIVE  GLOBAL  EXCLUSIVE
SylabsCloud  cloud.sylabs.io  YES     YES     NO

Keyservers
==========

URI                     GLOBAL  INSECURE  ORDER
https://keys.sylabs.io  YES     NO        1*

* Active cloud services keyserver

Authenticated Logins
=================================

URI                 INSECURE
docker://docker.io  NO
</pre></div>
</div>
<p>Now we can see that <code class="docutils literal notranslate"><span class="pre">docker://docker.io</span></code> shows up under
<code class="docutils literal notranslate"><span class="pre">Authenticated</span> <span class="pre">Logins</span></code> and Singularity will automatically supply the
configured credentials when interacting with DockerHub. We can also see
the <code class="docutils literal notranslate"><span class="pre">INSECURE</span></code> column indicating that Singularity will use TLS when
communicating with the registry.</p>
<p>We can login to multiple OCI registries at the same time:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity remote login --username ian docker://registry.example.com
Password (or token when username is empty):
INFO:    Token stored in /home/ian/.singularity/remote.yaml

$ singularity remote list
Cloud Services Endpoints
========================

NAME         URI              ACTIVE  GLOBAL  EXCLUSIVE
SylabsCloud  cloud.sylabs.io  YES     YES     NO

Keyservers
==========

URI                     GLOBAL  INSECURE  ORDER
https://keys.sylabs.io  YES     NO        1*

* Active cloud services keyserver

Authenticated Logins
=================================

URI                            INSECURE
docker://docker.io             NO
docker://registry.example.com  NO
</pre></div>
</div>
<p>Singularity will supply the correct credentials for the registry based off of
the hostname when using the following commands with a <code class="docutils literal notranslate"><span class="pre">docker://</span></code> or
<code class="docutils literal notranslate"><span class="pre">oras://</span></code> URI:</p>
<p><a class="reference external" href="cli/singularity_pull.html">pull</a>,
<a class="reference external" href="cli/singularity_push.html">push</a>,
<a class="reference external" href="cli/singularity_build.html">build</a>,
<a class="reference external" href="cli/singularity_exec.html">exec</a>,
<a class="reference external" href="cli/singularity_shell.html">shell</a>,
<a class="reference external" href="cli/singularity_run.html">run</a>,
<a class="reference external" href="cli/singularity_instance.html">instance</a></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is important for users to be aware that the login command will store the
supplied credentials or tokens unencrypted in your home directory.</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="cloud_library.html" class="btn btn-neutral float-right" title="Cloud Library" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="encryption.html" class="btn btn-neutral float-left" title="Encrypted Containers" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017-2021, HPCng.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>