

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>OCI Runtime Support &mdash; Singularity User Guide 3.7 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />

  
  
    <link rel="shortcut icon" href="_static/favicon.png"/>
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/js/ga.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Plugins" href="plugins.html" />
    <link rel="prev" title="Environment and Metadata" href="environment_and_metadata.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Singularity User Guide
          

          
            
            <img src="_static/logo.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                3.7
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction to Singularity</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="security.html">Security in Singularity</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="build_a_container.html">Build a container</a></li>
<li class="toctree-l1"><a class="reference internal" href="definition_files.html">The Definition File</a></li>
<li class="toctree-l1"><a class="reference internal" href="build_env.html">Build Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="singularity_and_docker.html">Singularity and Docker</a></li>
<li class="toctree-l1"><a class="reference internal" href="fakeroot.html">Fakeroot feature</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="signNverify.html">Sign and Verify</a></li>
<li class="toctree-l1"><a class="reference internal" href="key_commands.html">Key management commands</a></li>
<li class="toctree-l1"><a class="reference internal" href="encryption.html">Encrypted Containers</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="endpoint.html">Remote Endpoints</a></li>
<li class="toctree-l1"><a class="reference internal" href="cloud_library.html">Cloud Library</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="bind_paths_and_mounts.html">Bind Paths and Mounts</a></li>
<li class="toctree-l1"><a class="reference internal" href="persistent_overlays.html">Persistent Overlays</a></li>
<li class="toctree-l1"><a class="reference internal" href="running_services.html">Running Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment_and_metadata.html">Environment and Metadata</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">OCI Runtime Support</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mounted-oci-filesystem-bundles">Mounted OCI Filesystem Bundles</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#mounting-an-oci-filesystem-bundle">Mounting an OCI Filesystem Bundle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#content-of-an-oci-compliant-filesystem-bundle">Content of an OCI Compliant Filesystem Bundle</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#creating-oci-compliant-container-instances">Creating OCI Compliant Container Instances</a></li>
<li class="toctree-l2"><a class="reference internal" href="#unmounting-oci-filesystem-bundles">Unmounting OCI Filesystem Bundles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#kubernetes-integration">Kubernetes Integration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="security_options.html">Security Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="networking.html">Network Options</a></li>
<li class="toctree-l1"><a class="reference internal" href="cgroups.html">Cgroups Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="mpi.html">Singularity and MPI applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="gpu.html">GPU Support</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command Line Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">License</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Singularity User Guide</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content style-external-links">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>OCI Runtime Support</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            
              <a href="https://github.com/hpcng/singularity-userdocs/blob/master/oci_runtime.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <span class="target" id="oci-runtime"></span><div class="section" id="oci-runtime-support">
<h1>OCI Runtime Support<a class="headerlink" href="#oci-runtime-support" title="Permalink to this headline">¶</a></h1>
<div class="section" id="overview">
<span id="sec-oci-runtime-overview"></span><h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>OCI is an acronym for the <a class="reference external" href="https://www.opencontainers.org/">Open Containers Initiative</a> - an independent organization whose mandate is to develop open standards relating to containerization. To date, standardization efforts have focused on container formats and runtimes. Singularity’s compliance with respect to the OCI Image Specification is considered in detail <a class="reference internal" href="singularity_and_docker.html#sec-oci-overview"><span class="std std-ref">elsewhere</span></a>. It is Singularity’s compliance with the OCI Runtime Specification that is of concern here.</p>
<p>Briefly, compliance with respect to the OCI Runtime Specification is addressed in Singularity through the introduction of the <code class="docutils literal notranslate"><span class="pre">oci</span></code> command group. Although this command group can, in principle, be used to provide a runtime that supports end users, in this initial documentation effort, emphasis is placed upon interoperability with Kubernetes; more specifically, interoperability with Kubernetes via the <a class="reference external" href="https://www.sylabs.io/guides/cri/1.0/user-guide/index.html">Singularity Container Runtime Interface</a>.</p>
<p>Owing to this restricted focus, a subset of the Singularity <code class="docutils literal notranslate"><span class="pre">oci</span></code> command group receives attention here; specifically:</p>
<blockquote>
<div><ul class="simple">
<li><p>Mounting and unmounting OCI filesystem bundles</p></li>
<li><p>Creating OCI compliant container instances</p></li>
</ul>
</div></blockquote>
<p>Some context for integration with Kubernetes via the Singularity CRI is provided at the end of the section.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All commands in the <code class="docutils literal notranslate"><span class="pre">oci</span></code> command group require <code class="docutils literal notranslate"><span class="pre">root</span></code> privileges.</p>
</div>
</div>
<div class="section" id="mounted-oci-filesystem-bundles">
<h2>Mounted OCI Filesystem Bundles<a class="headerlink" href="#mounted-oci-filesystem-bundles" title="Permalink to this headline">¶</a></h2>
<div class="section" id="mounting-an-oci-filesystem-bundle">
<h3>Mounting an OCI Filesystem Bundle<a class="headerlink" href="#mounting-an-oci-filesystem-bundle" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://busybox.net/about.html">BusyBox</a> is used here for the purpose of illustration.</p>
<p>Suppose the Singularity Image Format (SIF) file <code class="docutils literal notranslate"><span class="pre">busybox_latest.sif</span></code> exists locally. (Recall:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ singularity pull docker://busybox
INFO:    Starting build...
Getting image source signatures
Copying blob sha256:fc1a6b909f82ce4b72204198d49de3aaf757b3ab2bb823cb6e47c416b97c5985
 738.13 KiB / 738.13 KiB [==================================================] 0s
Copying config sha256:5fffaf1f2c1830a6a8cf90eb27c7a1a8476b8c49b4b6261a20d6257d031ce4f3
 575 B / 575 B [============================================================] 0s
Writing manifest to image destination
Storing signatures
INFO:    Creating SIF file...
INFO:    Build complete: busybox_latest.sif
</pre></div>
</div>
<p>This is one way to bootstrap creation of this image in SIF that <em>retains</em> a local copy - i.e., a local copy of the SIF file <em>and</em> a cached copy of the OCI blobs. Additional approaches and details can be found in the section <a class="reference internal" href="singularity_and_docker.html#singularity-and-docker"><span class="std std-ref">Support for Docker and OCI</span></a>).</p>
<p>For the purpose of boostrapping the creation of an OCI compliant container, this SIF file can be mounted as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo singularity oci mount ./busybox_latest.sif /var/tmp/busybox
</pre></div>
</div>
<p>By issuing the <code class="docutils literal notranslate"><span class="pre">mount</span></code> command, the root filesystem encapsulated in the SIF file <code class="docutils literal notranslate"><span class="pre">busybox_latest.sif</span></code> is mounted on <code class="docutils literal notranslate"><span class="pre">/var/tmp/busybox</span></code> as an <code class="docutils literal notranslate"><span class="pre">overlay</span></code> file system,</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo df -k
Filesystem                   1K-blocks    Used Available Use% Mounted on
udev                            475192       0    475192   0% /dev
tmpfs                           100916    1604     99312   2% /run
/dev/mapper/vagrant--vg-root  19519312 2620740  15883996  15% /
tmpfs                           504560       0    504560   0% /dev/shm
tmpfs                             5120       0      5120   0% /run/lock
tmpfs                           504560       0    504560   0% /sys/fs/cgroup
tmpfs                           100912       0    100912   0% /run/user/900
overlay                       19519312 2620740  15883996  15% /var/tmp/busybox/rootfs
</pre></div>
</div>
<p>with permissions as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo ls -ld /var/tmp/busybox
drwx------ 4 root root 4096 Apr  4 14:30 /var/tmp/busybox
</pre></div>
</div>
</div>
<div class="section" id="content-of-an-oci-compliant-filesystem-bundle">
<h3>Content of an OCI Compliant Filesystem Bundle<a class="headerlink" href="#content-of-an-oci-compliant-filesystem-bundle" title="Permalink to this headline">¶</a></h3>
<p>The <em>expected</em> contents of the mounted filesystem are as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo ls -la /var/tmp/busybox
total 28
drwx------ 4 root root 4096 Apr  4 14:30 .
drwxrwxrwt 4 root root 4096 Apr  4 14:30 ..
-rw-rw-rw- 1 root root 9879 Apr  4 14:30 config.json
drwx------ 4 root root 4096 Apr  4 14:30 overlay
drwx------ 1 root root 4096 Apr  4 14:30 rootfs
</pre></div>
</div>
<p>From the perspective of the <a class="reference external" href="https://github.com/opencontainers/runtime-spec/blob/master/bundle.md">OCI runtime specification</a>, this content is expected because it prescribes a</p>
<blockquote>
<div><p>“… a format for encoding a container as a <strong>filesystem bundle</strong> - a set of files organized in a certain way, and containing all the necessary data and metadata for any compliant runtime to perform all standard operations against it.”</p>
</div></blockquote>
<p>Critical to compliance with the specification is the presence of the following <em>mandatory</em> artifacts residing locally in a single directory:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file - a file of configuration data that must reside in the root of the bundle directory under this name</p></li>
<li><p>The container’s root filesystem - a referenced directory</p></li>
</ol>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because the directory itself, i.e., <code class="docutils literal notranslate"><span class="pre">/var/tmp/busybox</span></code> is <em>not</em> part of the bundle, the mount point can be chosen arbitrarily.</p>
</div>
<p>The <a class="reference external" href="https://github.com/stedolan/jq">filtered</a> <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file corresponding to the OCI mounted <code class="docutils literal notranslate"><span class="pre">busybox_latest.sif</span></code> container can be detailed as follows via <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">sudo</span> <span class="pre">cat</span> <span class="pre">/var/tmp/busybox/config.json</span> <span class="pre">|</span> <span class="pre">jq</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
  <span class="nt">&quot;ociVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.1-dev&quot;</span><span class="p">,</span>
  <span class="nt">&quot;process&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;user&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;uid&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
      <span class="nt">&quot;gid&quot;</span><span class="p">:</span> <span class="mi">0</span>
    <span class="p">},</span>
    <span class="nt">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;/.singularity.d/actions/run&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;env&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="s2">&quot;PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin&quot;</span><span class="p">,</span>
      <span class="s2">&quot;TERM=xterm&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;cwd&quot;</span><span class="p">:</span> <span class="s2">&quot;/&quot;</span><span class="p">,</span>
    <span class="nt">&quot;capabilities&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;bounding&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;CAP_CHOWN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_DAC_OVERRIDE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_FSETID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_FOWNER&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_MKNOD&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_NET_RAW&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETGID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETUID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETFCAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETPCAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_NET_BIND_SERVICE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SYS_CHROOT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_KILL&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_AUDIT_WRITE&quot;</span>
      <span class="p">],</span>
      <span class="nt">&quot;effective&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;CAP_CHOWN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_DAC_OVERRIDE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_FSETID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_FOWNER&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_MKNOD&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_NET_RAW&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETGID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETUID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETFCAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETPCAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_NET_BIND_SERVICE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SYS_CHROOT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_KILL&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_AUDIT_WRITE&quot;</span>
      <span class="p">],</span>
      <span class="nt">&quot;inheritable&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;CAP_CHOWN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_DAC_OVERRIDE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_FSETID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_FOWNER&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_MKNOD&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_NET_RAW&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETGID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETUID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETFCAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETPCAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_NET_BIND_SERVICE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SYS_CHROOT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_KILL&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_AUDIT_WRITE&quot;</span>
      <span class="p">],</span>
      <span class="nt">&quot;permitted&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;CAP_CHOWN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_DAC_OVERRIDE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_FSETID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_FOWNER&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_MKNOD&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_NET_RAW&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETGID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETUID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETFCAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETPCAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_NET_BIND_SERVICE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SYS_CHROOT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_KILL&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_AUDIT_WRITE&quot;</span>
      <span class="p">],</span>
      <span class="nt">&quot;ambient&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;CAP_CHOWN&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_DAC_OVERRIDE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_FSETID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_FOWNER&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_MKNOD&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_NET_RAW&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETGID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETUID&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETFCAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SETPCAP&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_NET_BIND_SERVICE&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_SYS_CHROOT&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_KILL&quot;</span><span class="p">,</span>
        <span class="s2">&quot;CAP_AUDIT_WRITE&quot;</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="nt">&quot;rlimits&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;RLIMIT_NOFILE&quot;</span><span class="p">,</span>
        <span class="nt">&quot;hard&quot;</span><span class="p">:</span> <span class="mi">1024</span><span class="p">,</span>
        <span class="nt">&quot;soft&quot;</span><span class="p">:</span> <span class="mi">1024</span>
      <span class="p">}</span>
    <span class="p">]</span>
  <span class="p">},</span>
  <span class="nt">&quot;root&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;path&quot;</span><span class="p">:</span> <span class="s2">&quot;/var/tmp/busybox/rootfs&quot;</span>
  <span class="p">},</span>
  <span class="nt">&quot;hostname&quot;</span><span class="p">:</span> <span class="s2">&quot;mrsdalloway&quot;</span><span class="p">,</span>
  <span class="nt">&quot;mounts&quot;</span><span class="p">:</span> <span class="p">[</span>
    <span class="p">{</span>
      <span class="nt">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;/proc&quot;</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;proc&quot;</span><span class="p">,</span>
      <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;proc&quot;</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;/dev&quot;</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tmpfs&quot;</span><span class="p">,</span>
      <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;tmpfs&quot;</span><span class="p">,</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;nosuid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;strictatime&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mode=755&quot;</span><span class="p">,</span>
        <span class="s2">&quot;size=65536k&quot;</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;/dev/pts&quot;</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;devpts&quot;</span><span class="p">,</span>
      <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;devpts&quot;</span><span class="p">,</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;nosuid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;noexec&quot;</span><span class="p">,</span>
        <span class="s2">&quot;newinstance&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ptmxmode=0666&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mode=0620&quot;</span><span class="p">,</span>
        <span class="s2">&quot;gid=5&quot;</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;/dev/shm&quot;</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;tmpfs&quot;</span><span class="p">,</span>
      <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;shm&quot;</span><span class="p">,</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;nosuid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;noexec&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nodev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;mode=1777&quot;</span><span class="p">,</span>
        <span class="s2">&quot;size=65536k&quot;</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;/dev/mqueue&quot;</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mqueue&quot;</span><span class="p">,</span>
      <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;mqueue&quot;</span><span class="p">,</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;nosuid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;noexec&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nodev&quot;</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="p">{</span>
      <span class="nt">&quot;destination&quot;</span><span class="p">:</span> <span class="s2">&quot;/sys&quot;</span><span class="p">,</span>
      <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;sysfs&quot;</span><span class="p">,</span>
      <span class="nt">&quot;source&quot;</span><span class="p">:</span> <span class="s2">&quot;sysfs&quot;</span><span class="p">,</span>
      <span class="nt">&quot;options&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;nosuid&quot;</span><span class="p">,</span>
        <span class="s2">&quot;noexec&quot;</span><span class="p">,</span>
        <span class="s2">&quot;nodev&quot;</span><span class="p">,</span>
        <span class="s2">&quot;ro&quot;</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">],</span>
  <span class="nt">&quot;linux&quot;</span><span class="p">:</span> <span class="p">{</span>
    <span class="nt">&quot;resources&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;devices&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&quot;allow&quot;</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
          <span class="nt">&quot;access&quot;</span><span class="p">:</span> <span class="s2">&quot;rwm&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">},</span>
    <span class="nt">&quot;namespaces&quot;</span><span class="p">:</span> <span class="p">[</span>
      <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;pid&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;network&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;ipc&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;uts&quot;</span>
      <span class="p">},</span>
      <span class="p">{</span>
        <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;mount&quot;</span>
      <span class="p">}</span>
    <span class="p">],</span>
    <span class="nt">&quot;seccomp&quot;</span><span class="p">:</span> <span class="p">{</span>
      <span class="nt">&quot;defaultAction&quot;</span><span class="p">:</span> <span class="s2">&quot;SCMP_ACT_ERRNO&quot;</span><span class="p">,</span>
      <span class="nt">&quot;architectures&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;SCMP_ARCH_X86_64&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SCMP_ARCH_X86&quot;</span><span class="p">,</span>
        <span class="s2">&quot;SCMP_ARCH_X32&quot;</span>
      <span class="p">],</span>
      <span class="nt">&quot;syscalls&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="p">{</span>
          <span class="nt">&quot;names&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;accept&quot;</span><span class="p">,</span>
            <span class="s2">&quot;accept4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;access&quot;</span><span class="p">,</span>
            <span class="s2">&quot;alarm&quot;</span><span class="p">,</span>
            <span class="s2">&quot;bind&quot;</span><span class="p">,</span>
            <span class="s2">&quot;brk&quot;</span><span class="p">,</span>
            <span class="s2">&quot;capget&quot;</span><span class="p">,</span>
            <span class="s2">&quot;capset&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chdir&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chmod&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chown&quot;</span><span class="p">,</span>
            <span class="s2">&quot;chown32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;clock_getres&quot;</span><span class="p">,</span>
            <span class="s2">&quot;clock_gettime&quot;</span><span class="p">,</span>
            <span class="s2">&quot;clock_nanosleep&quot;</span><span class="p">,</span>
            <span class="s2">&quot;close&quot;</span><span class="p">,</span>
            <span class="s2">&quot;connect&quot;</span><span class="p">,</span>
            <span class="s2">&quot;copy_file_range&quot;</span><span class="p">,</span>
            <span class="s2">&quot;creat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;dup&quot;</span><span class="p">,</span>
            <span class="s2">&quot;dup2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;dup3&quot;</span><span class="p">,</span>
            <span class="s2">&quot;epoll_create&quot;</span><span class="p">,</span>
            <span class="s2">&quot;epoll_create1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;epoll_ctl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;epoll_ctl_old&quot;</span><span class="p">,</span>
            <span class="s2">&quot;epoll_pwait&quot;</span><span class="p">,</span>
            <span class="s2">&quot;epoll_wait&quot;</span><span class="p">,</span>
            <span class="s2">&quot;epoll_wait_old&quot;</span><span class="p">,</span>
            <span class="s2">&quot;eventfd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;eventfd2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;execve&quot;</span><span class="p">,</span>
            <span class="s2">&quot;execveat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;exit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;exit_group&quot;</span><span class="p">,</span>
            <span class="s2">&quot;faccessat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fadvise64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fadvise64_64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fallocate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fanotify_mark&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fchdir&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fchmod&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fchmodat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fchown&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fchown32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fchownat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fcntl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fcntl64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fdatasync&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fgetxattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;flistxattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;flock&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fork&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fremovexattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fsetxattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fstat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fstat64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fstatat64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fstatfs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fstatfs64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;fsync&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ftruncate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ftruncate64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;futex&quot;</span><span class="p">,</span>
            <span class="s2">&quot;futimesat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getcpu&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getcwd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getdents&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getdents64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getegid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getegid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;geteuid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;geteuid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getgid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getgid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getgroups&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getgroups32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getitimer&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getpeername&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getpgid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getpgrp&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getpid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getppid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getpriority&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getrandom&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getresgid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getresgid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getresuid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getresuid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getrlimit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;get_robust_list&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getrusage&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getsid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getsockname&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getsockopt&quot;</span><span class="p">,</span>
            <span class="s2">&quot;get_thread_area&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gettid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;gettimeofday&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getuid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getuid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;getxattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;inotify_add_watch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;inotify_init&quot;</span><span class="p">,</span>
            <span class="s2">&quot;inotify_init1&quot;</span><span class="p">,</span>
            <span class="s2">&quot;inotify_rm_watch&quot;</span><span class="p">,</span>
            <span class="s2">&quot;io_cancel&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ioctl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;io_destroy&quot;</span><span class="p">,</span>
            <span class="s2">&quot;io_getevents&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ioprio_get&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ioprio_set&quot;</span><span class="p">,</span>
            <span class="s2">&quot;io_setup&quot;</span><span class="p">,</span>
            <span class="s2">&quot;io_submit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ipc&quot;</span><span class="p">,</span>
            <span class="s2">&quot;kill&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lchown&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lchown32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lgetxattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;link&quot;</span><span class="p">,</span>
            <span class="s2">&quot;linkat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;listen&quot;</span><span class="p">,</span>
            <span class="s2">&quot;listxattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;llistxattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_llseek&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lremovexattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lseek&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lsetxattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lstat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;lstat64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;madvise&quot;</span><span class="p">,</span>
            <span class="s2">&quot;memfd_create&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mincore&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mkdir&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mkdirat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mknod&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mknodat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mlock&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mlock2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mlockall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mmap&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mmap2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mprotect&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mq_getsetattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mq_notify&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mq_open&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mq_timedreceive&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mq_timedsend&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mq_unlink&quot;</span><span class="p">,</span>
            <span class="s2">&quot;mremap&quot;</span><span class="p">,</span>
            <span class="s2">&quot;msgctl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;msgget&quot;</span><span class="p">,</span>
            <span class="s2">&quot;msgrcv&quot;</span><span class="p">,</span>
            <span class="s2">&quot;msgsnd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;msync&quot;</span><span class="p">,</span>
            <span class="s2">&quot;munlock&quot;</span><span class="p">,</span>
            <span class="s2">&quot;munlockall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;munmap&quot;</span><span class="p">,</span>
            <span class="s2">&quot;nanosleep&quot;</span><span class="p">,</span>
            <span class="s2">&quot;newfstatat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;_newselect&quot;</span><span class="p">,</span>
            <span class="s2">&quot;open&quot;</span><span class="p">,</span>
            <span class="s2">&quot;openat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pause&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pipe&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pipe2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;poll&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ppoll&quot;</span><span class="p">,</span>
            <span class="s2">&quot;prctl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pread64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;preadv&quot;</span><span class="p">,</span>
            <span class="s2">&quot;prlimit64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pselect6&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pwrite64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;pwritev&quot;</span><span class="p">,</span>
            <span class="s2">&quot;read&quot;</span><span class="p">,</span>
            <span class="s2">&quot;readahead&quot;</span><span class="p">,</span>
            <span class="s2">&quot;readlink&quot;</span><span class="p">,</span>
            <span class="s2">&quot;readlinkat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;readv&quot;</span><span class="p">,</span>
            <span class="s2">&quot;recv&quot;</span><span class="p">,</span>
            <span class="s2">&quot;recvfrom&quot;</span><span class="p">,</span>
            <span class="s2">&quot;recvmmsg&quot;</span><span class="p">,</span>
            <span class="s2">&quot;recvmsg&quot;</span><span class="p">,</span>
            <span class="s2">&quot;remap_file_pages&quot;</span><span class="p">,</span>
            <span class="s2">&quot;removexattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rename&quot;</span><span class="p">,</span>
            <span class="s2">&quot;renameat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;renameat2&quot;</span><span class="p">,</span>
            <span class="s2">&quot;restart_syscall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rmdir&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rt_sigaction&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rt_sigpending&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rt_sigprocmask&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rt_sigqueueinfo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rt_sigreturn&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rt_sigsuspend&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rt_sigtimedwait&quot;</span><span class="p">,</span>
            <span class="s2">&quot;rt_tgsigqueueinfo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sched_getaffinity&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sched_getattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sched_getparam&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sched_get_priority_max&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sched_get_priority_min&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sched_getscheduler&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sched_rr_get_interval&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sched_setaffinity&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sched_setattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sched_setparam&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sched_setscheduler&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sched_yield&quot;</span><span class="p">,</span>
            <span class="s2">&quot;seccomp&quot;</span><span class="p">,</span>
            <span class="s2">&quot;select&quot;</span><span class="p">,</span>
            <span class="s2">&quot;semctl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;semget&quot;</span><span class="p">,</span>
            <span class="s2">&quot;semop&quot;</span><span class="p">,</span>
            <span class="s2">&quot;semtimedop&quot;</span><span class="p">,</span>
            <span class="s2">&quot;send&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sendfile&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sendfile64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sendmmsg&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sendmsg&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sendto&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setfsgid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setfsgid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setfsuid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setfsuid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setgid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setgid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setgroups&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setgroups32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setitimer&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setpgid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setpriority&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setregid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setregid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setresgid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setresgid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setresuid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setresuid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setreuid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setreuid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setrlimit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;set_robust_list&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setsid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setsockopt&quot;</span><span class="p">,</span>
            <span class="s2">&quot;set_thread_area&quot;</span><span class="p">,</span>
            <span class="s2">&quot;set_tid_address&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setuid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setuid32&quot;</span><span class="p">,</span>
            <span class="s2">&quot;setxattr&quot;</span><span class="p">,</span>
            <span class="s2">&quot;shmat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;shmctl&quot;</span><span class="p">,</span>
            <span class="s2">&quot;shmdt&quot;</span><span class="p">,</span>
            <span class="s2">&quot;shmget&quot;</span><span class="p">,</span>
            <span class="s2">&quot;shutdown&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sigaltstack&quot;</span><span class="p">,</span>
            <span class="s2">&quot;signalfd&quot;</span><span class="p">,</span>
            <span class="s2">&quot;signalfd4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sigreturn&quot;</span><span class="p">,</span>
            <span class="s2">&quot;socket&quot;</span><span class="p">,</span>
            <span class="s2">&quot;socketcall&quot;</span><span class="p">,</span>
            <span class="s2">&quot;socketpair&quot;</span><span class="p">,</span>
            <span class="s2">&quot;splice&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;stat64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;statfs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;statfs64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;symlink&quot;</span><span class="p">,</span>
            <span class="s2">&quot;symlinkat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sync&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sync_file_range&quot;</span><span class="p">,</span>
            <span class="s2">&quot;syncfs&quot;</span><span class="p">,</span>
            <span class="s2">&quot;sysinfo&quot;</span><span class="p">,</span>
            <span class="s2">&quot;syslog&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tee&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tgkill&quot;</span><span class="p">,</span>
            <span class="s2">&quot;time&quot;</span><span class="p">,</span>
            <span class="s2">&quot;timer_create&quot;</span><span class="p">,</span>
            <span class="s2">&quot;timer_delete&quot;</span><span class="p">,</span>
            <span class="s2">&quot;timerfd_create&quot;</span><span class="p">,</span>
            <span class="s2">&quot;timerfd_gettime&quot;</span><span class="p">,</span>
            <span class="s2">&quot;timerfd_settime&quot;</span><span class="p">,</span>
            <span class="s2">&quot;timer_getoverrun&quot;</span><span class="p">,</span>
            <span class="s2">&quot;timer_gettime&quot;</span><span class="p">,</span>
            <span class="s2">&quot;timer_settime&quot;</span><span class="p">,</span>
            <span class="s2">&quot;times&quot;</span><span class="p">,</span>
            <span class="s2">&quot;tkill&quot;</span><span class="p">,</span>
            <span class="s2">&quot;truncate&quot;</span><span class="p">,</span>
            <span class="s2">&quot;truncate64&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ugetrlimit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;umask&quot;</span><span class="p">,</span>
            <span class="s2">&quot;uname&quot;</span><span class="p">,</span>
            <span class="s2">&quot;unlink&quot;</span><span class="p">,</span>
            <span class="s2">&quot;unlinkat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;utime&quot;</span><span class="p">,</span>
            <span class="s2">&quot;utimensat&quot;</span><span class="p">,</span>
            <span class="s2">&quot;utimes&quot;</span><span class="p">,</span>
            <span class="s2">&quot;vfork&quot;</span><span class="p">,</span>
            <span class="s2">&quot;vmsplice&quot;</span><span class="p">,</span>
            <span class="s2">&quot;wait4&quot;</span><span class="p">,</span>
            <span class="s2">&quot;waitid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;waitpid&quot;</span><span class="p">,</span>
            <span class="s2">&quot;write&quot;</span><span class="p">,</span>
            <span class="s2">&quot;writev&quot;</span>
          <span class="p">],</span>
          <span class="nt">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;SCMP_ACT_ALLOW&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="nt">&quot;names&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;personality&quot;</span>
          <span class="p">],</span>
          <span class="nt">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;SCMP_ACT_ALLOW&quot;</span><span class="p">,</span>
          <span class="nt">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="nt">&quot;index&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
              <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
              <span class="nt">&quot;op&quot;</span><span class="p">:</span> <span class="s2">&quot;SCMP_CMP_EQ&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="nt">&quot;index&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
              <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="mi">8</span><span class="p">,</span>
              <span class="nt">&quot;op&quot;</span><span class="p">:</span> <span class="s2">&quot;SCMP_CMP_EQ&quot;</span>
            <span class="p">},</span>
            <span class="p">{</span>
              <span class="nt">&quot;index&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
              <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="mi">4294967295</span><span class="p">,</span>
              <span class="nt">&quot;op&quot;</span><span class="p">:</span> <span class="s2">&quot;SCMP_CMP_EQ&quot;</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="nt">&quot;names&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;chroot&quot;</span>
          <span class="p">],</span>
          <span class="nt">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;SCMP_ACT_ALLOW&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="nt">&quot;names&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;clone&quot;</span>
          <span class="p">],</span>
          <span class="nt">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;SCMP_ACT_ALLOW&quot;</span><span class="p">,</span>
          <span class="nt">&quot;args&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
              <span class="nt">&quot;index&quot;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
              <span class="nt">&quot;value&quot;</span><span class="p">:</span> <span class="mi">2080505856</span><span class="p">,</span>
              <span class="nt">&quot;op&quot;</span><span class="p">:</span> <span class="s2">&quot;SCMP_CMP_MASKED_EQ&quot;</span>
            <span class="p">}</span>
          <span class="p">]</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="nt">&quot;names&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;arch_prctl&quot;</span>
          <span class="p">],</span>
          <span class="nt">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;SCMP_ACT_ALLOW&quot;</span>
        <span class="p">},</span>
        <span class="p">{</span>
          <span class="nt">&quot;names&quot;</span><span class="p">:</span> <span class="p">[</span>
            <span class="s2">&quot;modify_ldt&quot;</span>
          <span class="p">],</span>
          <span class="nt">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;SCMP_ACT_ALLOW&quot;</span>
        <span class="p">}</span>
      <span class="p">]</span>
    <span class="p">}</span>
  <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Furthermore, and through use of <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">sudo</span> <span class="pre">cat</span> <span class="pre">/var/tmp/busybox/config.json</span> <span class="pre">|</span> <span class="pre">jq</span> <span class="pre">[.root.path]</span></code>, the property</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
        <span class="s2">&quot;/var/tmp/busybox/rootfs&quot;</span>
<span class="p">]</span>
</pre></div>
</div>
<p>identifies <code class="docutils literal notranslate"><span class="pre">/var/tmp/busybox/rootfs</span></code> as the container’s root filesystem, as required by the standard; this filesystem has contents:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo ls /var/tmp/busybox/rootfs
bin  dev  environment  etc  home  proc  root  singularity  sys  tmp  usr  var
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><code class="docutils literal notranslate"><span class="pre">environment</span></code> and <code class="docutils literal notranslate"><span class="pre">singularity</span></code> above are symbolic links to the <code class="docutils literal notranslate"><span class="pre">.singularity.d</span></code> directory.</p>
</div>
<p>Beyond <code class="docutils literal notranslate"><span class="pre">root.path</span></code>, the <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file includes a multitude of additional properties - for example:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ociVersion</span></code> - a mandatory property that identifies the version of the OCI runtime specification that the bundle is compliant with</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">process</span></code> - an optional property that specifies the container process. When invoked via Singularity, subproperties such as <code class="docutils literal notranslate"><span class="pre">args</span></code> are populated by making use of the contents of the <code class="docutils literal notranslate"><span class="pre">.singularity.d</span></code> directory, e.g. via <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">sudo</span> <span class="pre">cat</span> <span class="pre">/var/tmp/busybox/config.json</span> <span class="pre">|</span> <span class="pre">jq</span> <span class="pre">[.process.args]</span></code>:</p></li>
</ul>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">[</span>
  <span class="p">[</span>
    <span class="s2">&quot;/.singularity.d/actions/run&quot;</span>
  <span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">run</span></code> equates to the <a class="reference internal" href="singularity_and_docker.html#sec-inspect-container-metadata"><span class="std std-ref">familiar runscript</span></a> for this container. If image creation is bootstrapped via a Docker or OCI agent, Singularity will make use of <code class="docutils literal notranslate"><span class="pre">ENTRYPOINT</span></code> or <code class="docutils literal notranslate"><span class="pre">CMD</span></code> (from the OCI image) to populate <code class="docutils literal notranslate"><span class="pre">args</span></code>; for additional discussion, please refer to <a class="reference internal" href="singularity_and_docker.html#sec-def-files-execution"><span class="std std-ref">Directing Execution</span></a> in the section <a class="reference internal" href="singularity_and_docker.html#singularity-and-docker"><span class="std std-ref">Support for Docker and OCI</span></a>.</p>
</div></blockquote>
<p>For a comprehensive discussion of all the <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file properties, refer to the <a class="reference external" href="https://github.com/opencontainers/runtime-spec/blob/master/config.md">implementation guide</a>.</p>
<p>Technically, the <code class="docutils literal notranslate"><span class="pre">overlay</span></code> directory was <em>not</em> content expected of an OCI compliant filesystem bundle. As detailed in the section dedicated to <a class="reference external" href="https://www.sylabs.io/guides/3.0/user-guide/persistent_overlays.html">Persistent Overlays</a>, these directories allow for the introduction of
a writable file system on an otherwise immutable read-only container; thus they permit the illusion of read-write access.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>SIF is stated to be an extensible format; by encapsulating a filesystem bundle that conforms with the OCI runtime specification, this extensibility is evident.</p>
</div>
</div>
</div>
<div class="section" id="creating-oci-compliant-container-instances">
<h2>Creating OCI Compliant Container Instances<a class="headerlink" href="#creating-oci-compliant-container-instances" title="Permalink to this headline">¶</a></h2>
<p>SIF files encapsulate the OCI runtime. By ‘OCI mounting’ a SIF file (see above), this encapsulated runtime is revealed; please refer to the note below for additional details. Once revealed, the filesystem bundle can be used to bootstrap the creation of an OCI compliant container instance as follows:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo singularity oci create -b /var/tmp/busybox busybox1
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Data for the <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file exists within the SIF file as a descriptor for images pulled or built from Docker/OCI registries. For images sourced elsewhere, a default <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file is created when the <code class="docutils literal notranslate"><span class="pre">singularity</span> <span class="pre">oci</span> <span class="pre">mount</span> <span class="pre">...</span></code> command is issued.</p>
<p>Upon invocation, <code class="docutils literal notranslate"><span class="pre">singularity</span> <span class="pre">oci</span> <span class="pre">mount</span> <span class="pre">...</span></code> also mounts the root filesystem stored in the SIF file on <code class="docutils literal notranslate"><span class="pre">/bundle/rootfs</span></code>, and establishes an overlay filesystem on the mount point <code class="docutils literal notranslate"><span class="pre">/bundle/overlay</span></code>.</p>
</div>
<p>In this example, the filesystem bundle is located in the directory <code class="docutils literal notranslate"><span class="pre">/var/tmp/busybox</span></code> - i.e., the mount point identified above with respect to ‘OCI mounting’. The <code class="docutils literal notranslate"><span class="pre">config.json</span></code> file, along with the <code class="docutils literal notranslate"><span class="pre">rootfs</span></code> and <code class="docutils literal notranslate"><span class="pre">overlay</span></code> filesystems, are all employed in the bootstrap process. The instance is named <code class="docutils literal notranslate"><span class="pre">busybox1</span></code> in this example.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The outcome of this creation request is truly a container <strong>instance</strong>. Multiple instances of the same container can easily be created by simply changing the name of the instance upon subsequent invocation requests.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">state</span></code> of the container instance can be determined via <code class="docutils literal notranslate"><span class="pre">$</span> <span class="pre">sudo</span> <span class="pre">singularity</span> <span class="pre">oci</span> <span class="pre">state</span> <span class="pre">busybox1</span></code>:</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="nt">&quot;ociVersion&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.1-dev&quot;</span><span class="p">,</span>
<span class="nt">&quot;id&quot;</span><span class="p">:</span> <span class="s2">&quot;busybox1&quot;</span><span class="p">,</span>
<span class="nt">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;created&quot;</span><span class="p">,</span>
<span class="nt">&quot;pid&quot;</span><span class="p">:</span> <span class="mi">6578</span><span class="p">,</span>
<span class="nt">&quot;bundle&quot;</span><span class="p">:</span> <span class="s2">&quot;/var/tmp/busybox&quot;</span><span class="p">,</span>
<span class="nt">&quot;createdAt&quot;</span><span class="p">:</span> <span class="mi">1554389921452964253</span><span class="p">,</span>
<span class="nt">&quot;attachSocket&quot;</span><span class="p">:</span> <span class="s2">&quot;/var/run/singularity/instances/root/busybox1/attach.sock&quot;</span><span class="p">,</span>
<span class="nt">&quot;controlSocket&quot;</span><span class="p">:</span> <span class="s2">&quot;/var/run/singularity/instances/root/busybox1/control.sock&quot;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Container state, as conveyed via these properties, is in compliance with the OCI runtime specification as detailed <a class="reference external" href="https://github.com/opencontainers/runtime-spec/blob/master/runtime.md#state">here</a>.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">create</span></code> command has a number of options available. Of these, real-time logging to a file is likely to be of particular value - e.g., in deployments where auditing requirements exist.</p>
</div>
<div class="section" id="unmounting-oci-filesystem-bundles">
<h2>Unmounting OCI Filesystem Bundles<a class="headerlink" href="#unmounting-oci-filesystem-bundles" title="Permalink to this headline">¶</a></h2>
<p>To unmount a mounted OCI filesystem bundle, the following command should be issued:</p>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>$ sudo singularity oci umount /var/tmp/busybox
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The argument provided to <code class="docutils literal notranslate"><span class="pre">oci</span> <span class="pre">umount</span></code> above is the name of the bundle path, <code class="docutils literal notranslate"><span class="pre">/var/tmp/busybox</span></code>, as opposed to the mount point for the overlay filesystem, <code class="docutils literal notranslate"><span class="pre">/var/tmp/busybox/rootfs</span></code>.</p>
</div>
</div>
<div class="section" id="kubernetes-integration">
<h2>Kubernetes Integration<a class="headerlink" href="#kubernetes-integration" title="Permalink to this headline">¶</a></h2>
<p>As noted at the <a class="reference internal" href="#sec-oci-runtime-overview"><span class="std std-ref">outset here</span></a>, in documenting support for an OCI runtime in Singularity, the impetus is initially derived from the requirement to integrate with <a class="reference external" href="https://kubernetes.io/">Kubernetes</a>. Simply stated, Kubernetes is an open-source system for orchestrating containers; developed originally at Google, Kubernetes was contributed as seed technology to the <a class="reference external" href="https://www.cncf.io/">Cloud Native Compute Foundation</a> (CNCF). At this point, Kubernetes is regarded as a Graduated Project by CNCF, and is being used widely in production deployments. Even though Kubernetes emphasizes an orientation around services, it is appealing to those seeking to orchestrate containers having compute-driven requirements. Furthermore, emerging classes of workload in AI for example, appear to have requirements that are best addressed by a combination of service and traditional HPC infrastructures. Thus there is ample existing, as well as emerging, interest in integrating Singularity containers with Kubernetes.</p>
<p>The connection with support for the OCI runtime documented here, within the context of a Singularity-Kubernetes integration, can be best established through an architectural schematic. Dating back to the introduction of a Container Runtime Interface (CRI) for Kubernetes in late 2016, the schematic below is a modified version of the original presented in <a class="reference external" href="https://kubernetes.io/blog/2016/12/container-runtime-interface-cri-in-kubernetes/">a Kubernetes blog post</a>. The lower branch of this schematic is essentially a reproduction of the original; it does however, place emphasis on OCI compliance in terms of the CRI and containers (the runtime as well as their instances).</p>
<img alt="_images/sycri_ociruntime_implementation.png" src="_images/sycri_ociruntime_implementation.png" />
<p>From this schematic it is evident that integrating Singularity containers with Kubernetes requires the following efforts:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Implementation of a CRI for Singularity</p></li>
<li><p>Implementation of an OCI runtime in Singularity</p></li>
</ol>
</div></blockquote>
<p>The implementation of a CRI for Singularity is the emphasis of a separate and distinct <a class="reference external" href="https://github.com/sylabs/singularity-cri">open source project</a>; the implementation of this CRI is documented here. For the rationale conveyed through the architectural schematic, Singularity CRI’s dependence upon Singularity with OCI runtime support is made clear as <a class="reference external" href="https://www.sylabs.io/guides/cri/1.0/user-guide/installation.html?highlight=oci#install-dependencies">an installation prerequisite</a>. User-facing documentation for Singularity CRI details usage in a Kubernetes context - usage, of course, that involves orchestration of a Singularity container obtained from the <a class="reference external" href="https://cloud.sylabs.io/library">Sylabs Cloud Container Library</a>. Because the entire Kubernetes-based deployment can exist within a single instance of a Singularity container, Singularity CRI can be easily evaluated via Sykube; inspired by <a class="reference external" href="https://kubernetes.io/docs/setup/minikube/">Minikube</a>, <a class="reference external" href="https://www.sylabs.io/guides/cri/1.0/user-guide/sykube.html">use of Sykube</a> is included in the documentation for Singularity CRI.</p>
<p>Documenting the implementation of an OCI-compliant runtime for Singularity has been the emphasis here. Although this standalone runtime can be used by end users independent of anything to do with Singularity and Kubernetes, the primary purpose here has been documenting it within this integrated context. In other words, by making use of the OCI runtime presented by Singularity, commands originating from Kubernetes (see, e.g., <a class="reference external" href="https://sylabs.io/guides/cri/1.0/user-guide/examples.html">Basic Usage</a> in the Singularity CRI documentation) have impact ultimately on Singularity containers via the CRI. Singularity CRI is implemented as a <a class="reference external" href="https://grpc.io/">gRPC</a> server - i.e., a persistent service available to <a class="reference external" href="https://kubernetes.io/docs/reference/command-line-tools-reference/kubelet/">Kubelets</a> (node agents). Taken together, this integration allows Singularity containers to be manipulated directly from Kubernetes.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="plugins.html" class="btn btn-neutral float-right" title="Plugins" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="environment_and_metadata.html" class="btn btn-neutral float-left" title="Environment and Metadata" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2017-2020, Sylabs Inc.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>